(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e2be6f4"],{"602b":function(e,t,l){"use strict";var a=l("a566"),r=l.n(a);r.a},a566:function(e,t,l){},be94:function(e,t,l){"use strict";function a(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function r(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},r=Object.keys(l);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),r.forEach(function(t){a(e,t,l[t])})}return e}l.d(t,"a",function(){return r})},da72:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"user"},[e._m(0),l("el-card",{staticClass:"header-search"},[l("header",{attrs:{slot:"header"},slot:"header"},[l("el-form",{attrs:{inline:"",model:e.formSearch,size:"small"}},[l("el-form-item",{attrs:{label:"用户名"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formSearch.username,callback:function(t){e.$set(e.formSearch,"username",t)},expression:"formSearch.username"}})],1),l("el-form-item",{attrs:{label:"姓名"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formSearch.truename,callback:function(t){e.$set(e.formSearch,"truename",t)},expression:"formSearch.truename"}})],1),l("el-form-item",{attrs:{label:"用户类型"}},[l("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.formSearch.usertype,callback:function(t){e.$set(e.formSearch,"usertype",t)},expression:"formSearch.usertype"}},[l("el-option",{attrs:{label:"教职工",value:"2"}}),l("el-option",{attrs:{label:"学生",value:"4"}})],1)],1),l("el-form-item",{attrs:{label:"部门"}},[l("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.formSearch.deptId,callback:function(t){e.$set(e.formSearch,"deptId",t)},expression:"formSearch.deptId"}},e._l(e.deptList,function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1)],1)],1),l("div",{staticClass:"btn-group"},[l("el-button-group",[l("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.add}},[e._v("新增")]),l("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.del}},[e._v("删除")]),l("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.edit}},[e._v("修改")])],1),l("el-button-group",[l("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.grant}},[e._v("分配角色")])],1)],1),l("el-table",{attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),l("el-table-column",{attrs:{prop:"username",label:"用户名","min-width":"150"}}),l("el-table-column",{attrs:{prop:"truename",label:"姓名","min-width":"150"}}),l("el-table-column",{attrs:{prop:"usertype",label:"类型","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("2"===t.row.usertype?"教职工":"学生")+"\n                ")]}}])}),l("el-table-column",{attrs:{prop:"sex",label:"性别","min-width":"80"}}),l("el-table-column",{attrs:{prop:"roleStr",label:"当前用户角色","min-width":"200"}})],1),l("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.formSearch.page,"page-sizes":[10,20,50,100,200,500],"page-size":e.formSearch.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),l("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[l("header",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.dialogName))]),l("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.rules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"用户名",prop:"username"}},[l("el-input",{attrs:{disabled:"编辑"===e.dialogName,placeholder:"请输入",clearable:""},model:{value:e.dialogForm.username,callback:function(t){e.$set(e.dialogForm,"username",t)},expression:"dialogForm.username"}})],1),l("el-form-item",{attrs:{label:"姓名",prop:"truename"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.dialogForm.truename,callback:function(t){e.$set(e.dialogForm,"truename",t)},expression:"dialogForm.truename"}})],1),l("el-form-item",{attrs:{label:"用户类型",prop:"usertype"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dialogForm.usertype,callback:function(t){e.$set(e.dialogForm,"usertype",t)},expression:"dialogForm.usertype"}},[l("el-option",{attrs:{label:"教职工",value:"2"}}),l("el-option",{attrs:{label:"学生",value:"4"}})],1)],1),l("el-form-item",{attrs:{label:"性别",prop:"sex"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dialogForm.sex,callback:function(t){e.$set(e.dialogForm,"sex",t)},expression:"dialogForm.sex"}},[l("el-option",{attrs:{label:"男",value:"男"}}),l("el-option",{attrs:{label:"女",value:"女"}})],1)],1),l("el-form-item",{attrs:{label:"部门"}},[l("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.dialogForm.deptId,callback:function(t){e.$set(e.dialogForm,"deptId",t)},expression:"dialogForm.deptId"}},e._l(e.deptList,function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),l("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.dialogForm.mobile,callback:function(t){e.$set(e.dialogForm,"mobile",t)},expression:"dialogForm.mobile"}})],1),l("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.dialogForm.email,callback:function(t){e.$set(e.dialogForm,"email",t)},expression:"dialogForm.email"}})],1),l("el-form-item",{attrs:{label:"地址",prop:"address"}},[l("el-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.dialogForm.address,callback:function(t){e.$set(e.dialogForm,"address",t)},expression:"dialogForm.address"}})],1)],1),l("footer",{attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("dialogForm")}}},[e._v("确 定")])],1)],1),l("el-dialog",{attrs:{visible:e.dialogVisibleRole},on:{"update:visible":function(t){e.dialogVisibleRole=t}}},[l("header",{attrs:{slot:"title"},slot:"title"},[e._v("分配角色")]),l("el-checkbox-group",{model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},e._l(e.roleList,function(t){return l("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),l("footer",{attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogVisibleRole=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.submitRole}},[e._v("确 定")])],1)],1)],1)},r=[function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("fieldset",[l("legend",[e._v("用户")])])}],o=l("be94"),i={name:"user",data:function(){return{formSearch:{username:"",truename:"",usertype:"",deptId:"",page:1,limit:10},total:1,deptList:[],tableData:[],multipleSelection:[],dialogVisible:!1,dialogName:"",dialogForm:{username:"",truename:"",usertype:"",sex:"",deptId:"",mobile:"",email:"",address:""},rules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],truename:[{required:!0,message:"姓名不能为空",trigger:"blur"}],usertype:[{required:!0,message:"请选择用户类型",trigger:"change"}],deptId:[{required:!0,message:"请选择部门",trigger:"change"}]},dialogVisibleRole:!1,roleList:[],roleIds:[]}},computed:{role:function(){return this.$store.state.role}},created:function(){var e=this;this.$ajax.post("/dept/list").then(function(t){e.deptList=t.data.data.data}),this.$ajax.post("/role/list").then(function(t){e.roleList=t.data.data.data}),this.getTableData()},methods:{getTableData:function(){var e=this;this.$ajax.post("/user/page",this.formSearch).then(function(t){e.total=t.data.data.records,e.tableData=t.data.data.data})},handleSelectionChange:function(e){this.multipleSelection=e},add:function(){for(var e in this.dialogForm)delete this.dialogForm[e];this.dialogVisible=!0,this.dialogName="添加"},edit:function(){0===this.multipleSelection.length?this.$message.warning("请选择数据"):this.multipleSelection.length>1?this.$message.warning("只能选择一项编辑"):(this.dialogForm=Object(o["a"])({},this.multipleSelection[0]),this.dialogVisible=!0,this.dialogName="编辑")},submitForm:function(e){var t=this,l="添加"===this.dialogName?"/user/add":"/user/edit";this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log(t.dialogForm),t.$ajax.post(l,t.dialogForm).then(function(e){t.handleCurrentChange(1),t.dialogVisible=!1,t.$message.success(e.data.errmsg)})})},del:function(){var e=this;if(0===this.multipleSelection.length)this.$message.warning("请选择数据");else{for(var t=[],l=0;l<this.multipleSelection.length;l++)t.push(this.multipleSelection[l].id);this.$ajax.post("/user/remove",{userids:t}).then(function(t){e.handleCurrentChange(1),e.$message.success(t.data.errmsg)})}},grant:function(){0===this.multipleSelection.length?this.$message.warning("请选择数据"):(console.log(this.roleIds),this.roleIds=[],this.dialogVisibleRole=!0)},submitRole:function(){var e=this,t=[];for(var l in this.multipleSelection)t.push(this.multipleSelection[l].id);this.$ajax.post("/user/batchGrant ",{userIds:t,roleIds:this.roleIds}).then(function(t){e.handleCurrentChange(1),e.dialogVisibleRole=!1,e.$message.success(t.data.errmsg)})},handleSizeChange:function(e){this.formSearch.limit=e,this.formSearch.page=1,this.getTableData()},handleCurrentChange:function(e){this.formSearch.page=e,this.getTableData()}}},s=i,n=(l("602b"),l("2877")),u=Object(n["a"])(s,a,r,!1,null,null,null);u.options.__file="user.vue";t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2e2be6f4.ba3d69df.js.map